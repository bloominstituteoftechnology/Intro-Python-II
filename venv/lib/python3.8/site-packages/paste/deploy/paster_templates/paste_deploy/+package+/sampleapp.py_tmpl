import cgi

from paste.deploy.config import CONFIG


def application(environ, start_response):
    # Note that usually you wouldn't be writing a pure WSGI
    # application, you might be using some framework or
    # environment.  But as an example...
    start_response('200 OK', [('Content-type', 'text/html')])
    greeting = CONFIG['greeting']
    content = [
        b'<html><head><title>%s</title></head>\n' % greeting.encode('utf-8'),
        b'<body><h1>%s!</h1>\n' % greeting.encode('utf-8'),
        b'<table border=1>\n',
        ]
    items = environ.items()
    items = sorted(items)
    for key, value in items:
        content.append(b'<tr><td>%s</td><td>%s</td></tr>\n'
                       % (key.encode('utf-8'), cgi.escape(repr(value)).encode('utf-8')))
    content.append(b'</table></body></html>')
    return content
